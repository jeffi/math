package edu.unc.cs.robotics.math;

import java.util.HashSet;
import java.util.Set;

import junit.framework.TestCase;

/**
 * Created by jeffi on 12/19/16.
 */
public class MersenneTwisterTest extends TestCase {
    static final long[] FIRST_1000 = {
        2469588189546311528L,
        2516265689700432462L,
        8323445853463659930L,
        387828560950575246L,
        6472927700900931384L,
        -1635155404376545207L,
        8683844110200328628L,
        1372899666868390665L,
        -7934919560468864768L,
        -6728796361845342192L,
        1650120169738923776L,
        -8187054262401486053L,
        -3880236284922749339L,
        4088419662272158307L,
        7723071212801033180L,
        4607589428530663833L,
        5383952696905791169L,
        -3629649207981832006L,
        8754710472449431523L,
        4979504948613991400L,
        5276540162199416783L,
        -4630302813719249049L,
        8450906350267941188L,
        5648147264555499867L,
        5935407806829245027L,
        2087693315605466394L,
        2201677803204209739L,
        1275019617348169777L,
        -5630667282447914216L,
        -6497003672531589686L,
        -3870024879212820313L,
        7240788496498474165L,
        -8671126145853822079L,
        7348638884426327828L,
        3511468872326104046L,
        -7434208487002060612L,
        -2058281939954010862L,
        6836463893453737491L,
        709058728226756229L,
        5225314758959604220L,
        -2115757488044082032L,
        4828892980252724528L,
        -8845489467904936592L,
        360104468617048957L,
        -9099997238708077317L,
        -19916829656531990L,
        -7218134798856041617L,
        -1285034239541866897L,
        -2355234081369623426L,
        2989632402154269522L,
        -3768520746013652485L,
        9118433712641305188L,
        -8286524414128918684L,
        -5002049148312611999L,
        258728028113263814L,
        8297365668480671047L,
        3380355767021192235L,
        1046336359414364951L,
        3539983877178611158L,
        225998475647652457L,
        1560164250864816987L,
        11214792687780511L,
        2474913802110528348L,
        4261951405298700608L,
        -1636916788791373617L,
        -7813477595751470603L,
        -1404365514713675027L,
        450001171264865359L,
        -4336501151021912606L,
        -4626273659387381494L,
        -4361611152063511224L,
        -241726865101386564L,
        -8032461541176199042L,
        8956954616786449235L,
        4538870303492810039L,
        -711456455034199857L,
        -6254325442401563303L,
        -8463208016932556859L,
        -7432961136357158573L,
        -7893760330533367951L,
        -5752319107970460326L,
        -5151125407293069399L,
        8477314609861406317L,
        -6714042177987709791L,
        -4156454527758774594L,
        -1901799141830959156L,
        -6029874518859529396L,
        6663485319518390762L,
        209847351751748195L,
        2638294851452309388L,
        9120192583622090691L,
        -5004670871326389037L,
        -4046537534199837254L,
        4996318156502086710L,
        2595339487406353823L,
        -4183460892981364112L,
        8740675804441496180L,
        -613738722839834318L,
        -1989030029006315288L,
        -5870375252257546721L,
        -6656197780705130336L,
        -2220657403011403115L,
        -4333541200683647390L,
        796649480181245772L,
        -2459015282020846649L,
        4950387297804356702L,
        -844865133950117142L,
        1294689203150832878L,
        5306361945186877049L,
        7567633507232716428L,
        -5203087935103963299L,
        -6486877022924991469L,
        -7545484577032183477L,
        1738586212740179167L,
        1864669925611410908L,
        4282958424984823251L,
        -5518686117088384799L,
        6522059726478692099L,
        9166512306854239216L,
        -6176875450554685927L,
        -6191176533601630373L,
        5681207281174544133L,
        4141261287708293617L,
        -3617725689176698037L,
        -4793910776266747844L,
        2799924936169623783L,
        -3935402643250387086L,
        9206677855437990315L,
        4875967202607082616L,
        -9145525711365416419L,
        9098340840935354411L,
        6854001384045550207L,
        -8966777641469270257L,
        4186101649117248878L,
        5214998817066827086L,
        7566286530798553251L,
        2303176175526374214L,
        -3501564815377019471L,
        -2654733662903393441L,
        -2379786306547835180L,
        1024696805634422140L,
        8699565205355362593L,
        -5326169098976867893L,
        416896280955422526L,
        -2161233161350383689L,
        -6304715027809368473L,
        -5110464637617843633L,
        6819863802196767472L,
        879147482532216568L,
        -8979698895600358561L,
        -7117053855262447621L,
        6752015022389702040L,
        7281372179919347752L,
        -5638278390142332712L,
        3314189486039136022L,
        8573432893358607887L,
        -7498624338901482252L,
        8474828255843816221L,
        432448093127642350L,
        8896484606601961354L,
        7971543326454850997L,
        5477695767078343880L,
        1726344651239295304L,
        6049082636212711240L,
        2409096471038884539L,
        6689259129029100516L,
        -3194345535602440473L,
        -8691014004555166785L,
        594211839545724019L,
        -1081990136712855576L,
        3879544895415220709L,
        5956454734725064845L,
        -8696677725217702973L,
        -1365998262118682146L,
        -7775087666635973978L,
        -8929569559368246477L,
        6910987753922557097L,
        5018769469788454591L,
        8180900802564027862L,
        -6790002874350713256L,
        8948137648503548848L,
        -1696629109540269396L,
        -6666638140214693551L,
        -7735041116385887272L,
        9039251920829183914L,
        3856123576696970490L,
        3881910207450163143L,
        8975173172682091481L,
        -2318554765229678356L,
        -1604828862825173052L,
        5021032765023411341L,
        8346288968466611670L,
        -8030509205467702592L,
        3933543710783767669L,
        887042455399015066L,
        -5337329973603183852L,
        -6798697832903616771L,
        8883041788072192150L,
        -7117117209488378549L,
        1090101464740160766L,
        7561931734880991882L,
        -4572911997940818115L,
        1940523248490869985L,
        -5437315543661352732L,
        1561086229665138575L,
        1173233709665205816L,
        3422300316220009178L,
        -3019053368396053594L,
        -7552373586096387002L,
        -2006657375625962710L,
        -897103300929127097L,
        374786078730187938L,
        -7250431251878220871L,
        -9214007865041190658L,
        7807644625418533116L,
        -4803384548264266926L,
        4467571341992484613L,
        -8949241879120790658L,
        -9096217024626772655L,
        8586599758472251281L,
        8292239348167853766L,
        2637049307484284517L,
        -7674166468356744370L,
        -6247373450095301922L,
        7897837973541832718L,
        8799334334039425026L,
        -8636344200098514018L,
        4811526791052023707L,
        -1745584810734021994L,
        4795801783311711160L,
        -5819051430774897747L,
        -6758255109169579584L,
        -1559747082581939552L,
        -827927064185123531L,
        -3959854157990275158L,
        -5484514650078307828L,
        7002037481695833764L,
        8834865270610922167L,
        7037803164608059281L,
        -6818862326814791945L,
        -6346908283240141153L,
        -187980466384471115L,
        6876059647762239270L,
        -4300347695782201844L,
        2699833315974872561L,
        -7909655712728090571L,
        4302688748345604970L,
        5290821413132698296L,
        -5549998416894397588L,
        -3601744829640838470L,
        -5064162893898789209L,
        7433425839500326715L,
        3738803788169513140L,
        2593182918933739157L,
        7740326260523555347L,
        3415697013241730526L,
        8593560071533535064L,
        6276830223225278607L,
        -5450569972177595091L,
        307803011279269488L,
        8583940990015930795L,
        7972591088668761504L,
        -2589902559612147814L,
        -7269627859088763867L,
        6120572672510151391L,
        -6304613783927501167L,
        1130814466401358382L,
        -7826916100429062200L,
        -3559477782739653024L,
        -1566855165027081957L,
        -1000356888025724152L,
        -4687464642218275674L,
        1404023428702967486L,
        7524183488230557113L,
        -3571990614613625357L,
        6672571438107677867L,
        5841258325574502761L,
        -6657407755376439230L,
        -6727514636330046045L,
        -5449989485630153660L,
        -187165006192548346L,
        8316403115511139837L,
        8911404480249769099L,
        -1949494901118898531L,
        -412112678285377501L,
        7368938232868974846L,
        3981938894684859897L,
        -3342306016560350281L,
        -2316359982944267760L,
        -3334371209029628932L,
        2391654472444670452L,
        -2638765339565197706L,
        1809108843113272319L,
        -5824300670991599234L,
        4646095102014800228L,
        -6037293632352976539L,
        2076119985795110610L,
        -5507429630186054138L,
        237754147528630023L,
        1865297830882079327L,
        -1385704953739134756L,
        8845145305942395243L,
        3705065327286208975L,
        6807519019316426644L,
        -1555700325661861248L,
        -3973370656635546734L,
        4494374856508098946L,
        -5320046787963458063L,
        1092876010683250480L,
        9076988746523470422L,
        -6107878827085882224L,
        7051797671038026992L,
        4522861927766102283L,
        -5166686772604691613L,
        4050548200253063695L,
        -5590046453442321916L,
        -9201592289056744913L,
        3692146100191425796L,
        -4010306316008858398L,
        -1248169431994968104L,
        6279833809320305920L,
        -2810793382391855945L,
        -284438344067499835L,
        6841700862561548280L,
        -6579098960453860589L,
        1676622157736832418L,
        -4646259766448017006L,
        2837517387144545246L,
        8838312884422755462L,
        -7042642561086483282L,
        -157197070370682653L,
        -3600566062884792240L,
        -6184314281865203265L,
        -1746617204714144102L,
        -2268657525068106564L,
        7949673160486059625L,
        -7314065576164581616L,
        -1960167054376020441L,
        3654467034091358359L,
        -145182852618393396L,
        -4277377985024017521L,
        -177443241652346028L,
        -5013599437995382218L,
        8698755867467867311L,
        8045634161558880023L,
        7518635957743825560L,
        -896970590910114294L,
        -2101679316593200589L,
        6557400189305886849L,
        -4458323929125581344L,
        -4703187243995758221L,
        9222483377988212844L,
        8783614816023661377L,
        1007128605806957436L,
        -2009603983611586885L,
        -4001605504010695977L,
        -8668061939473636425L,
        -8761756405110918721L,
        7313283796933301434L,
        6348968936753488491L,
        2458275775367017136L,
        -5260613709324645517L,
        7912436054148684731L,
        -1092792334420406968L,
        4830425452226424971L,
        -9205708396414626442L,
        -197041969272645781L,
        -7052695025839033023L,
        4712088185711679361L,
        -378951573219338985L,
        7494661684559968420L,
        -5701744754546275035L,
        -8466625634560974181L,
        -4333187208071580956L,
        2890332731873369251L,
        -5477589024071003878L,
        -5585746690221446224L,
        9156181100885921582L,
        4995954043270555234L,
        -9049423869117084391L,
        2853936408248562350L,
        6853731849998694242L,
        5020463153462166043L,
        1530078916125426336L,
        -9170424088254270549L,
        272174921682255693L,
        -5079877686629697701L,
        -4697676985578919207L,
        7601211051108858735L,
        -8333182901820007834L,
        -3063447820748477683L,
        6067055627840318275L,
        -6337387004735433609L,
        -137096287716334208L,
        7343469497275244040L,
        -8068281352305624955L,
        3590426675516651743L,
        3167813776712768256L,
        8878176073467878829L,
        3924791031397745131L,
        235245676965715888L,
        6840662447749535302L,
        -5943702698324717425L,
        -655978611443929166L,
        8743625541288232856L,
        -1915778839817102127L,
        7998471784986336801L,
        -6554769394623626234L,
        -7409943513946850246L,
        6395130035020396471L,
        5830978747185563101L,
        1617706303914894781L,
        6211366185910824400L,
        -8555148107472898151L,
        8607287636145087656L,
        -4163674728182129943L,
        -4167473342860692985L,
        -610546808521676950L,
        2978692378820306999L,
        -4839128592195427653L,
        8598511747396841702L,
        6156091662766835059L,
        -7707237157939800313L,
        8612712317997410098L,
        -1914422047186330369L,
        1683718654015550468L,
        5944512566047423157L,
        -8207313606464166853L,
        -3972198364138019923L,
        -5557211537862028670L,
        -5676331952397628105L,
        -5287631305594253602L,
        -8310584376779763432L,
        -2215387413080140728L,
        6551435565840706944L,
        -8585249057439046945L,
        -7119291403015460627L,
        -744650822266990584L,
        7902954834487485408L,
        -8146426829583675726L,
        -8679755908238884309L,
        4928646508926815311L,
        -4929271354569656745L,
        263331873985907336L,
        -3859616710507148521L,
        -2906485627933199841L,
        2090035817915342142L,
        -7121548699280162134L,
        -3414168857641620893L,
        4364949548913593414L,
        -829687795504245803L,
        1745922975854681067L,
        2463993247529028336L,
        6083603846436529217L,
        1937262749667119433L,
        -4451393504597437029L,
        -5795722967811769664L,
        7306677822813050272L,
        1961280511901704376L,
        -197852127766165968L,
        4135461658026341102L,
        -5586788464647251005L,
        8845189205306689520L,
        4255239899472995894L,
        8684364314600935401L,
        -9003416948751114984L,
        -188235162958806022L,
        -6892318571521230365L,
        -4279308119262667225L,
        2890498089160032748L,
        -3601998657200027472L,
        3562084939408321129L,
        4312465543893528099L,
        5351702239569443427L,
        -6171494037705033749L,
        -2573302195663412414L,
        -7298741626515632057L,
        -2981527847673034150L,
        8433470201079239486L,
        -2817628366039224051L,
        806738558946549866L,
        5318767891177373357L,
        402042665291837771L,
        -7967058670672266237L,
        -8675476254114348009L,
        -4842126779094302345L,
        7839528914581707112L,
        1421014001277273112L,
        -1489716771551052223L,
        7355757693103011987L,
        8830714720407209061L,
        -1980227724601420325L,
        8432739723513734588L,
        8033634158284398470L,
        4237905034976634300L,
        -8938527685956045568L,
        -7849050103817312751L,
        1521882757639801743L,
        6332486108920215483L,
        5472548897836996899L,
        -3871789921041138173L,
        -3509752441943517317L,
        -6924579582695697766L,
        -6135649588612214377L,
        4443029467577726074L,
        -3302434072853214365L,
        -769742906269810000L,
        7341619243832234810L,
        3953966823912829456L,
        9210033167581344496L,
        -6833517382703635862L,
        9100612372491360448L,
        -8559107052487824264L,
        649296145865240338L,
        -6854176568384826436L,
        -6354378131941946955L,
        1013126260113657462L,
        5774300643340885475L,
        -8870252680606296345L,
        5457614442972182319L,
        -3857608179936220260L,
        -8526319658535973676L,
        5529142974863395122L,
        -7600593973335382057L,
        311205995495648888L,
        9025536647968436328L,
        -8681083567385768109L,
        3988211710311325171L,
        -4374661704593903077L,
        -5806917785082907293L,
        8395251767851298416L,
        3869277641874518391L,
        9136795655591514191L,
        3869232365991246782L,
        -8366403346834107405L,
        7819231021552004423L,
        -1068946174477061662L,
        -8593464645755639324L,
        2675121567361301324L,
        2573952090262659737L,
        2725463971461170390L,
        -7488693927469006410L,
        -8146557721477903714L,
        -7360325259910920883L,
        -6074812057958686051L,
        3858330322494137600L,
        -6803220757462490653L,
        -1509571852984981221L,
        -8983618725864265780L,
        -640758196864694686L,
        -6617443053442342201L,
        5939868766987831931L,
        599460762532202451L,
        -283933710942294758L,
        -7174557764812149387L,
        4544875538792691832L,
        7564554250483875288L,
        8895055407854010198L,
        -2667327864402011318L,
        1438317093410506029L,
        4656144137522213648L,
        -7320937787265417775L,
        -5241192126199093689L,
        5487071769355701127L,
        7993967617906661583L,
        -6009919008028691952L,
        -6555908604601041641L,
        -6073074375297351265L,
        -1008705746058464987L,
        -5624000463375085519L,
        4389762172171114764L,
        -449492785191797221L,
        -7230975305165452512L,
        -112851505246751997L,
        -9140263385563108255L,
        -6981657054177695095L,
        -8225635155837279078L,
        -8354743460545005354L,
        4026382269391456481L,
        3361861622697504660L,
        393987691755805623L,
        -7665428959877157012L,
        -8833257091399376028L,
        7580765124297786817L,
        6643380527940424898L,
        6047973753893467044L,
        -6187862396817405650L,
        8466856769980077217L,
        -8739467347560369907L,
        3230384358563102791L,
        3976119076750841295L,
        -1740314671647580904L,
        -872263361020782461L,
        -4221770643594111028L,
        9008750857767158944L,
        -8110926041164387240L,
        2123596108752927331L,
        2333343982259732761L,
        -4492514278482364531L,
        -5297231395716156127L,
        -7279054119010521970L,
        -8743427159632583769L,
        -8753733566318536777L,
        -1176508193003156801L,
        -6249402685754908431L,
        847875652268717401L,
        1659195767307574305L,
        -6244943901209695647L,
        -3474388325212279894L,
        -4382889975066212262L,
        -8137904432284597584L,
        2429312614784701930L,
        -643654763287512418L,
        -7333775517446325606L,
        -9158915107615217783L,
        3985465976124347528L,
        -5949916822759302674L,
        -1000257786845842966L,
        2648131663154866230L,
        -601847389569222441L,
        4177849849203248788L,
        6911360117351562846L,
        2643633846852893955L,
        -289681316467036723L,
        37632317631463696L,
        1666342619962420621L,
        8634483195146265646L,
        -1090973883972882393L,
        -6246022236096724610L,
        6811959167301523800L,
        1251353797796887325L,
        -7510624967865725365L,
        143845830243301001L,
        7631460933703637232L,
        -1853300020941032594L,
        3292414776018864616L,
        6074485901684066800L,
        -548228243528942862L,
        7226441459082744856L,
        1000195285276713002L,
        1935315990130352476L,
        -9197149828279117550L,
        8829854336531819838L,
        2104442288820156922L,
        -7017884269430907783L,
        -8170047635857170717L,
        4085694859760906393L,
        -5525539125346489662L,
        -4601210818853750900L,
        740307233861765040L,
        6850799066617372890L,
        6906424943456985901L,
        -2077764891633469829L,
        1742614067880019880L,
        -6434663931290981483L,
        -349083521067704855L,
        -1070057791741915637L,
        -2046865021406667853L,
        8945493087235882400L,
        -7657132828268664194L,
        -4049784166082317338L,
        -8390592425672616603L,
        -6669425662502027573L,
        -2044019845704508185L,
        1454604692296173549L,
        -124631005065997474L,
        5096134835108504030L,
        1833298643547823163L,
        -3644758411127826048L,
        966687644581809708L,
        -1238232509067444395L,
        7632359859250021640L,
        1093032458490701613L,
        -4480816683619806107L,
        -6347005772403907234L,
        5983983286566414242L,
        6594252916285625322L,
        4567632427202436189L,
        963838040537303287L,
        4430529632777864839L,
        -2099478620695419806L,
        -8666179682806268847L,
        -6268751559898377984L,
        4612022372999951985L,
        2149675559966605365L,
        7981154345845723278L,
        -4220930320088448974L,
        5781700902984537764L,
        -659341877698190867L,
        6688062573786379193L,
        2796642708026117173L,
        -66432821296189546L,
        3939282556840707732L,
        -4469803538839228059L,
        -1924750983330520630L,
        3922142640406164397L,
        6920799549548680785L,
        4180624376357659359L,
        8981655909899762945L,
        -2636738869522807653L,
        -4344697919974096451L,
        -8887549725621465629L,
        -1491276077043104615L,
        3501173692636304956L,
        -693447182334291320L,
        3797603694461381123L,
        2798488595217178740L,
        -2469995385066583840L,
        -2978485369591461559L,
        -7098132770267686211L,
        -6757564754892326538L,
        -3223587223749137967L,
        4516683890697457036L,
        -2446542075497007003L,
        6493829969384747842L,
        -8012143735722800873L,
        -1743686384834527541L,
        -288836339753393504L,
        -9000814215445935955L,
        -8977572809189073130L,
        -4273035026008627949L,
        3237454628013335940L,
        4393215255988185144L,
        -5065032113334650654L,
        1752400338617613407L,
        -3152188930842105983L,
        2214901197208607320L,
        2051022871979981990L,
        -5805184950166853943L,
        -8094019168712355755L,
        -272576778467116497L,
        9119201222697071926L,
        -5310380109246217636L,
        -4919375763389104015L,
        -1796901306221163530L,
        -8672915496936292378L,
        -28805777493488605L,
        -1476509908602664895L,
        -4131502591483663129L,
        -6275560369920158427L,
        3371881277834986396L,
        -4751739726591435688L,
        1117343712930231208L,
        2461430133081876942L,
        8392444246619584181L,
        5783193002555676243L,
        -3445042580972858155L,
        8673789298725651948L,
        -6749223494955185595L,
        -817186296687820792L,
        6208066903357236434L,
        -8323626734142969430L,
        7651370015357714715L,
        -639174762635720862L,
        7913019348512975453L,
        2930852566847188124L,
        -8117950345159259876L,
        7898773096940421105L,
        -138603498204343560L,
        -3286798831267259538L,
        -1045573558197172586L,
        4131939041993863590L,
        -4525371710612598989L,
        -2474310857781522707L,
        -7554544872481062222L,
        -2621094342559377625L,
        1428261331195078236L,
        -8433626900885794754L,
        -7065558236844732676L,
        2427890748910261135L,
        2352540424646885438L,
        -7747388006328183326L,
        5455854655258698004L,
        3064284075901422580L,
        4889347544574182877L,
        -7329627045475991485L,
        8926076285941912215L,
        -5089981727538039260L,
        118864776182547799L,
        -8880322590971516997L,
        6290804498349359908L,
        -2123532371211181233L,
        -1587355567984819430L,
        -958645404040933178L,
        4565608270772125694L,
        -8655262308140249151L,
        1731839752576924786L,
        -110319513602803935L,
        -5399152633418426945L,
        6375597874523696668L,
        142031301668739766L,
        8464469694800541582L,
        -5745652946156523559L,
        -7818258821205345068L,
        8889909719593610677L,
        -2698225453085449109L,
        2853553604689883927L,
        -4863934722824136225L,
        -9147819246742067274L,
        6948373023332234460L,
        875917081447860568L,
        8663480387091270479L,
        7489934533795922302L,
        4881611095694055798L,
        5656599059928498020L,
        7121354336434325714L,
        -8792893801048758275L,
        -7848739436274740675L,
        -2592675597932919078L,
        -4026479246931280504L,
        -6706905208086058733L,
        -7548894319888501036L,
        -6328117309197464309L,
        -3621602383819605980L,
        1730638821390469201L,
        -2337472305747223888L,
        7486225764691050451L,
        -2371772333451636740L,
        1916222624575997629L,
        7803252432536922758L,
        -2969444076350775923L,
        1294801674465415874L,
        3655009371483369687L,
        -1640814357147593601L,
        4038844772301150704L,
        -837833570929782840L,
        -1716414936851621898L,
        -5785891071221700171L,
        2309264593032723008L,
        -8080094357792965675L,
        -2691253084258512607L,
        -8176222421711467638L,
        -3117221723271282206L,
        -361215009446719849L,
        -1776762847414132724L,
        -4701678348403357982L,
        3411409017607749548L,
        8511062786628439508L,
        -6389464183420558390L,
        3507883715081555573L,
        1476895777425321522L,
        1727792216894648908L,
        4549740429963962207L,
        -8708845281300160959L,
        2824095341872283236L,
        -8820776706659873813L,
        -1204896902428510982L,
        -1514781868660220355L,
        -7994072137683864975L,
        6424988610066373017L,
        7012739238760576133L,
        -3017708782641733336L,
        9199381347419799329L,
        -160192106172094117L,
        -342442646678046156L,
        8392171591449284205L,
        5005889767564434351L,
        5430887297926168278L,
        3781223516454044283L,
        -4998576156284118319L,
        -8725959425608660809L,
        8055889531308447537L,
        1029209974131520387L,
        8558536563256740859L,
        -8539515622418344371L,
        4949336525867228862L,
        -4680769150788683628L,
        -7652165000202675922L,
        -7001062240827487418L,
        -3034749666579238220L,
        2447635979962951982L,
        -6172306721673149161L,
        1421676950762912213L,
        -8597674101463547556L,
        4127167943815367580L,
        6042679087952613035L,
        -7232949220054831018L,
        3795091060959194624L,
        3638983481306238177L,
        -7534956224110527922L,
        6122615429756696653L,
        -938501514711012212L,
        -3034717572496265746L,
        -6469837983664796918L,
        -3105060617581770194L,
        -8573434653323092155L,
        8440049359477146976L,
        5331988686375969032L,
        -796136944234161686L,
        2495402489954278681L,
        -9135294276571369209L,
        5175041804110960608L,
        -7318774277117175136L,
        -9219211858972450754L,
        -7356129788306174671L,
        -7577969035826738223L,
        2661044084672610595L,
        -7208229062505888409L,
        2226492259359655569L,
        4076769176988690392L,
        -4324946482922384754L,
        -28250475778444113L,
        8360759577527705335L,
        5940024277524035583L,
        -3642881449290452597L,
        5960129112251646018L,
        4663206357305706531L,
        -4231893416633679483L,
        2521765390425068383L,
        -7412933348668810020L,
        -4506804303162522965L,
        -7747163318490427817L,
        1053725605410736452L,
        5019450334070505473L,
        -4948441865865756551L,
        4237101458781285739L,
        -959281056121695278L,
        -392309487068299262L,
        -7679907537298557092L,
        -6062022897785955194L,
        5793810010124053279L,
        -5931642912530784634L,
        7929832535255373279L,
        3639893836145180591L,
        225842092746460263L,
        -6735392783532385L,
        -6509245428328996950L,
        -6856340049647354732L,
        4108994544462991685L,
        -2260846849987663200L,
        -5306707825443120414L,
        -4910727630773587398L,
        7433363529993938850L,
        -2506976964677698015L,
        -5453168611295977577L,
        -392549309093723517L,
        8832253044581033941L,
        -3879685475394366933L,
        -5591704733385773428L,
        6379679286505609848L,
        -6426151763756680920L,
        -3043189096982471179L,
        -4627191369969495767L,
        2604807733685538111L,
        316467331532612104L,
        7103257718958846285L,
        -5273647504527662650L,
        -3458366088848984319L,
        -6360351308132496457L,
        -7102584474750640961L,
        -7247295552444087876L,
        4881258824203071790L,
        3958574232839923419L,
        2891867463463800177L,
        8242447672389996940L,
        4061349312055410165L,
        4556032297931603385L,
        -4025959325175794374L,
        -5899278836517978292L,
        -1515052811187754909L,
        -2826732561519300379L,
        1681908266984373431L,
        -861020273584445051L,
        7043882867077053441L,
        4930923495460562502L,
        -5781205682146184430L,
        -1671199017595014265L,
        -8947646077262124764L,
        7927714214624727723L,
        4414506177258134252L,
        5649015660553724766L,
        -4269088947651085740L,
        8232722671694014977L,
        8489648026118048405L,
        -4785110254122394958L,
        -6799116393639287968L,
        4678212904669724611L,
        5208393625186775634L,
        7189293270352260631L,
        8182602203245492693L,
        -636994466375998774L,
        8994102002235434367L,
        -8656763107632765294L,
        -3358232065527572142L,
        3565187450937106567L,
        2708754128993108120L,
        3756390757507340561L,
        5241453318180460589L,
        8750662221492511258L,
        -7847433678003799418L,
        5211332780314791055L,
        2354656750794837318L,
        9129887266808914629L,
        -5669084065096082431L,
        7918727352793577680L,
        5892482795030071505L,
        -3959145524110768787L,
        4878730560427123167L,
        7745104319000119214L,
        6281021426621908634L,
        };

    public void testFirst1000WithKnownSeed() throws Exception {
        MersenneTwister mt = new MersenneTwister(1);
        // assertEquals(2469588189546311528L, mt.nextLong());
        for (long expected : FIRST_1000) {
            assertEquals(expected, mt.nextLong());
        }
    }

    public void testNextDouble() throws Exception {
        MersenneTwister mt = new MersenneTwister(1);
        double min = Double.POSITIVE_INFINITY;
        double max = Double.NEGATIVE_INFINITY;
        double sum = 0;
        int N = 1000000;

        for (int i = 0 ; i < N ; ++i) {
            double v = mt.nextDouble();
            min = Math.min(min, v);
            max = Math.max(max, v);
            sum += v - 0.5;
        }

        assertEquals(0.0, min, 1e-5);
        assertEquals(1.0, max, 1e-5);
        assertEquals(0.5, sum/N + 0.5, 1e-4);
    }

    /**
     * Each new MersenneTwister created with the default constructor should
     * be uniquely seeded.  Note this test is non-deterministic in that there
     * is a very small possibility that two MersenneTwisters will be seeded
     * with the same value.
     *
     * @throws Exception
     */
    public void testSeeding() throws Exception {
        Set<Long> initialValues = new HashSet<>();
        for (int i = 0 ; i < 1000 ; ++i) {
            long v = new MersenneTwister().nextLong();
            assertTrue(initialValues.add(v));
        }
    }

    /**
     * Make sure we can generate random numbers quickly.
     * This test that we can generate 1 mil longs in less than 1 second.
     * It takes about 15 ms on an Intel Core i7 Haswell architecture.
     * <p>
     * On one machine, this produces:
     * 181,477,502 random 64-bit numbers / second
     * <p>
     * On the same machine, RDRAND (intel hardware random number generated) produces
     * 9,573,042 random 64-bit numbers / second
     *
     * @throws Exception
     */
    public void testBenchmark() throws Exception {
        final int N = 1_000_000;
        MersenneTwister mt = new MersenneTwister(1);
        long start = System.nanoTime();
        for (int i = 0 ; i < N ; ++i)
            mt.nextLong();
        double elapsed = (System.nanoTime() - start)*1e-9;
        assertTrue("time to generated " + N + " randoms: " + elapsed + " seconds", elapsed < 1.0);
    }

    public void testUniqueness() throws Exception {
        // With 1,000,000 values out of 2^64 possible, if the algorithm
        // really mimics randomness, then then chance of a collision is
        // approximately 0.00000000000000054%.
        final int N = 1_000_000;
        final MersenneTwister mt = new MersenneTwister(1);
        Set<Long> set = new HashSet<>(N);
        for (int i = 0 ; i < N ; ++i)
            assertTrue(set.add(mt.nextLong()));
    }
}